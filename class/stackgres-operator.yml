parameters:
  kapitan:
    dependencies:
      - type: helm
        output_path: dependencies/stackgres-operator/helmcharts/stackgres-operator/${stackgres_operator:charts:stackgres_operator:version}
        source: ${stackgres_operator:charts:stackgres_operator:source}
        version: ${stackgres_operator:charts:stackgres_operator:version}
        chart_name: stackgres-operator
    compile:
      - input_paths:
          - ${_base_directory}/component/app.jsonnet
        input_type: jsonnet
        output_path: apps/
      - input_paths:
          - ${_base_directory}/component/main.jsonnet
         # - ${_base_directory}/component/pre.jsonnet
         # - ${_base_directory}/component/scriptsPermissions.jsonnet
        input_type: jsonnet
        output_path: stackgres-operator/
      - output_path: stackgres-operator/01_helmchart
        input_type: helm
        input_paths:
          - dependencies/stackgres-operator/helmcharts/stackgres-operator/${stackgres_operator:charts:stackgres_operator:version}/
        helm_values: ${stackgres_operator:helmValues}
        helm_params:
          name: stackgres-operator
          namespace: ${stackgres_operator:namespace}
          api_versions: "project.openshift.io/v1"
          kube_version: ${stackgres_operator:kubernetesVersion}
  commodore:
    postprocess:
      filters:
        - type: jsonnet
          filter: postprocess/fix_null_entries.jsonnet
          path: ${_instance}/01_helmchart/stackgres-operator/crds
        - type: jsonnet
          filter: postprocess/fix_sgconfig_null_entries.jsonnet
          path: ${_instance}/01_helmchart/stackgres-operator/templates
