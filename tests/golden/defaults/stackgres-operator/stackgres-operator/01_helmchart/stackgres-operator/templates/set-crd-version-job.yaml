apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    helm.sh/hook: post-install,post-upgrade
    helm.sh/hook-delete-policy: before-hook-creation,hook-succeeded
    helm.sh/hook-weight: '60'
  labels:
    app: stackgres-operator-set-crd-version
    job: set-crd-version
    scope: init
  name: stackgres-operator-set-crd-version
  namespace: syn-stackgres-operator
spec:
  template:
    metadata:
      labels:
        app: stackgres-operator-set-crd-version
        job: set-crd-version
        scope: init
    spec:
      containers:
        - command:
            - /bin/bash
            - -ecx
            - "kubectl get crd -o name | grep '\\.stackgres\\.io$' \\\n  | while read\
              \ -r CRD\n    do\n      kubectl annotate --overwrite \"$CRD\" stackgres.io/operatorVersion=1.4.0\n\
              \    done\n"
          image: ongres/kubectl:v1.24.3-build-6.16
          imagePullPolicy: IfNotPresent
          name: set-crd-version
      restartPolicy: OnFailure
      securityContext:
        fsGroup: 1000
        runAsGroup: 1000
        runAsNonRoot: true
        runAsUser: 1000
      serviceAccountName: stackgres-operator-init
      terminationGracePeriodSeconds: 0
